// Mock Audit Logs Data - matches AuditLog type from @/types/audit.types.ts
import type { AuditLog, AuditAction, AuditEntityType, AuditSeverity } from '@/types';

export const MOCK_AUDIT_LOGS: AuditLog[] = [
  {
    id: 'audit-001',
    timestamp: '2024-12-01T10:30:00Z',
    userId: 'off-001',
    userName: 'Sgt. Kwame Mensah',
    userRole: 'officer',
    userBadgeNumber: 'GPS001',
    action: 'create' as AuditAction,
    entityType: 'ticket' as AuditEntityType,
    entityId: 'tkt-001',
    entityName: 'GPS-2024-00001',
    description: 'Ticket GPS-2024-00001 created for speeding violation',
    severity: 'info' as AuditSeverity,
    success: true,
    stationId: 'st-accra-central',
    stationName: 'Accra Central Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
    metadata: {
      ticketNumber: 'GPS-2024-00001',
      offence: 'SPD-001',
      fineAmount: 200,
    },
  },
  {
    id: 'audit-002',
    timestamp: '2024-12-05T14:20:00Z',
    userId: 'system',
    userName: 'System',
    userRole: 'system',
    action: 'update' as AuditAction,
    entityType: 'ticket' as AuditEntityType,
    entityId: 'tkt-001',
    entityName: 'GPS-2024-00001',
    description: 'Payment received for ticket GPS-2024-00001',
    severity: 'info' as AuditSeverity,
    success: true,
    stationId: 'st-accra-central',
    stationName: 'Accra Central Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
    oldValue: { status: 'pending', amountPaid: 0 },
    newValue: { status: 'paid', amountPaid: 200 },
    metadata: {
      paymentId: 'pay-001',
      paymentMethod: 'momo',
    },
  },
  {
    id: 'audit-003',
    timestamp: '2024-12-11T08:00:00Z',
    userId: 'off-003',
    userName: 'Insp. John Appiah',
    userRole: 'admin',
    userBadgeNumber: 'ADMIN01',
    action: 'login' as AuditAction,
    entityType: 'user' as AuditEntityType,
    entityId: 'off-003',
    description: 'User logged in successfully',
    severity: 'info' as AuditSeverity,
    success: true,
    ipAddress: '192.168.1.100',
    userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0',
    stationId: 'st-accra-central',
    stationName: 'Accra Central Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
  },
  {
    id: 'audit-004',
    timestamp: '2024-12-06T09:00:00Z',
    userId: 'off-003',
    userName: 'Insp. John Appiah',
    userRole: 'admin',
    userBadgeNumber: 'ADMIN01',
    action: 'change_status' as AuditAction,
    entityType: 'ticket' as AuditEntityType,
    entityId: 'tkt-005',
    entityName: 'GPS-2024-00005',
    description: 'Ticket GPS-2024-00005 cancelled',
    severity: 'warning' as AuditSeverity,
    success: true,
    stationId: 'st-airport',
    stationName: 'Airport Police Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
    oldValue: { status: 'pending' },
    newValue: { status: 'cancelled' },
    metadata: {
      reason: 'Ticket issued in error - vehicle was in authorized VIP parking area',
    },
  },
  {
    id: 'audit-005',
    timestamp: '2024-11-28T09:00:00Z',
    userId: 'off-003',
    userName: 'Insp. John Appiah',
    userRole: 'admin',
    action: 'approve' as AuditAction,
    entityType: 'objection' as AuditEntityType,
    entityId: 'obj-002',
    description: 'Objection for ticket GPS-2024-00009 approved',
    severity: 'info' as AuditSeverity,
    success: true,
    stationId: 'st-accra-central',
    stationName: 'Accra Central Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
    oldValue: { status: 'pending' },
    newValue: { status: 'approved' },
    metadata: {
      ticketNumber: 'GPS-2024-00009',
      reason: 'wrong_person',
    },
  },
  {
    id: 'audit-006',
    timestamp: '2024-12-10T11:15:00Z',
    userId: 'off-001',
    userName: 'Sgt. Kwame Mensah',
    userRole: 'officer',
    action: 'print' as AuditAction,
    entityType: 'ticket' as AuditEntityType,
    entityId: 'tkt-001',
    entityName: 'GPS-2024-00001',
    description: 'Ticket printed via thermal printer',
    severity: 'info' as AuditSeverity,
    success: true,
    stationId: 'st-accra-central',
    stationName: 'Accra Central Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
    metadata: { printMethod: 'thermal', copies: 2 },
  },
  {
    id: 'audit-007',
    timestamp: '2024-12-09T16:30:00Z',
    userId: 'super-001',
    userName: 'Grace Osei',
    userRole: 'super_admin',
    action: 'create' as AuditAction,
    entityType: 'station' as AuditEntityType,
    entityId: 'st-tema-new',
    entityName: 'Tema Industrial Station',
    description: 'New police station created in Tema Division',
    severity: 'info' as AuditSeverity,
    success: true,
    ipAddress: '10.0.0.50',
    regionId: 'ga',
    regionName: 'Greater Accra',
  },
  {
    id: 'audit-008',
    timestamp: '2024-12-08T14:00:00Z',
    userId: 'off-003',
    userName: 'Insp. John Appiah',
    userRole: 'admin',
    action: 'reject' as AuditAction,
    entityType: 'objection' as AuditEntityType,
    entityId: 'obj-003',
    description: 'Objection for ticket GPS-2024-00010 rejected',
    severity: 'info' as AuditSeverity,
    success: true,
    stationId: 'st-osu',
    stationName: 'Osu Police Station',
    regionId: 'ga',
    regionName: 'Greater Accra',
    metadata: { reviewNotes: 'Insufficient evidence to support claim' },
  },
  {
    id: 'audit-009',
    timestamp: '2024-12-11T09:45:00Z',
    userId: 'off-002',
    userName: 'Cpl. Sarah Osei',
    userRole: 'officer',
    action: 'login' as AuditAction,
    entityType: 'user' as AuditEntityType,
    entityId: 'off-002',
    description: 'Login attempt failed - invalid password',
    severity: 'warning' as AuditSeverity,
    success: false,
    errorMessage: 'Invalid password entered',
    ipAddress: '192.168.1.105',
    userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_0)',
  },
  {
    id: 'audit-010',
    timestamp: '2024-12-07T10:00:00Z',
    userId: 'super-001',
    userName: 'Grace Osei',
    userRole: 'super_admin',
    action: 'update' as AuditAction,
    entityType: 'offence' as AuditEntityType,
    entityId: 'off-001',
    entityName: 'Exceeding Speed Limit',
    description: 'Speeding fine increased from GHS 150 to GHS 200',
    severity: 'info' as AuditSeverity,
    success: true,
    oldValue: { defaultFine: 150 },
    newValue: { defaultFine: 200 },
    ipAddress: '10.0.0.50',
  },
];

// Helper to filter by date range
export function filterAuditLogsByDate(logs: AuditLog[], startDate?: string, endDate?: string): AuditLog[] {
  return logs.filter(log => {
    const logDate = new Date(log.timestamp);
    if (startDate && logDate < new Date(startDate)) return false;
    if (endDate && logDate > new Date(endDate)) return false;
    return true;
  });
}

// Helper to get stats
export function getAuditStats(logs: AuditLog[]) {
  const actionCounts: Record<string, number> = {};
  const entityCounts: Record<string, number> = {};
  
  logs.forEach(log => {
    actionCounts[log.action] = (actionCounts[log.action] || 0) + 1;
    entityCounts[log.entityType] = (entityCounts[log.entityType] || 0) + 1;
  });
  
  return {
    totalActions: logs.length,
    actionsByType: actionCounts,
    actionsByEntity: entityCounts,
    successRate: logs.filter(l => l.success).length / logs.length,
    recentActivity: logs.slice(0, 10),
  };
}

// Alias for index compatibility
export const getAuditLogStats = () => getAuditStats(MOCK_AUDIT_LOGS);
